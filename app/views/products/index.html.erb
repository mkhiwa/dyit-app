<p id="notice"><%= notice %></p>

<h1>Products</h1>

<table class='table table-striped table-dark'>
  <thead>
    <tr>
       <th scope="col">Order Date:</th>
      <th scope="col">Client Name:</th>
      <th scope="col">Code</th>
      <th scope="col">Description</th>
      <th scope="col">Status</th>
      <th scope="col">Quantity</th>
      <th scope="col">Price</th>
      <th scope="col">Total</th>
      <th scope="col">Paid</th>
      <th scope="col">Balance</th>
      <th colspan="3"></th>
    </tr>
  </thead>

  <tbody>
    <% @products.each do |product| %>
      <tr>
        <td scope="row"><%= product.created_at %></td>
        <td scope="row"><%= product.user.name %></td>
        <td scope="row"><%= product.code %></td>
        <td scope="row"><%= product.description %></td>
        <td scope="row"><%= product.status %></td>
        <td scope="row"><%= product.quantity %></td>
        <td scope="row"><%= number_to_currency(product.price,:unit => "E", :separator => ".", :delimiter => ",") %></td>
        <td scope="row"><font color="red"><%= number_to_currency(product.total,:unit => "E", :separator => ".", :delimiter => ",") %></font></td>
        <td scope="row"><font color="green"><%= number_to_currency(product.paid,:unit => "E", :separator => ".", :delimiter => ",") %></font></td>
        <td scope="row"><font color="red"><%= number_to_currency(product.balance, :unit => "E", :separator => ".", :delimiter => ",") %></font></td>

        <td><%= link_to 'Show', product %></td>
        
        <% if current_user.admin? %>
        <td><%= link_to 'Edit', edit_product_path(product) %></td>
        <td><%= link_to 'Destroy', product, method: :delete, data: { confirm: 'Are you sure?' } %></td>
        <% end %>
      </tr>
    <% end %>
  </tbody>
</table>



<br>

<%= link_to 'New Product', new_product_path %>

<script type="text/javascript">
     $(function() {
        $('#products').change(function() {
            var product_id = $(this).val()
            var price = eval($(this).data('price'))[product_id]
            $("#price").html(price)
        })
    })
</script>